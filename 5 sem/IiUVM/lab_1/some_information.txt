Структура SYSTEM_POWER_STATUS:

Type SYSTEM_POWER_STATUS {
    ACLineStatus As Byte;
    BatteryFlag As Byte;
    BatteryLifePercent As Byte;
    Reserved1 As Byte;
    BatteryLifeTime As Long;
    BatteryFullLifeTime As Long; 
} End Type

ACLineStatus
Состояние питания от сети. Может принимать одно из следующих значений:
  0	- Отключено;
  1	- Включено;
  255	- Неизвестное состояние.

BatteryFlag
Состояние зарядки батарей. Может содержать один или несколько флагов:
  1 -	Высокая степень заряда (более 66 процентов);
  2 -	Низкая степень заряда (менее 33 процентов);
  4 -	Критическая степень заряда (менее 5 процентов);
  8 -	Заряжается;
  128 -	Нет батарей;
  255	- Неизвестное состояние.

BatteryLifePercent
Оставшееся состояние до полной зарядки. Может иметь значение от 0 до 100 или 255, если состояние неизвестно.

Reserved1
Зарезервировано. Установите в 0.

BatteryLifeTime
Число секунд, оставшееся до разрядки батареи или -1, если оставшееся время неизвестно.

BatteryFullLifeTime
Число секунд жизни батареи при полном заряде или -1, если время неизвестно.
